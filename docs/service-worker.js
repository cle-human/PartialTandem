const GHPATH = "https://choffmann.eu/PartialTandem/app.html";
// Change to a different app prefix name
const APP_PREFIX = 'my_awesome_';
const VERSION = 'version_01';

// The files to make available for offline use. make sure to add 
// others to this list
const URLS = [
  `${GHPATH}/`,
	`${GHPATH}/app.html`,
	`${GHPATH}/app.json`,
	`${GHPATH}/edit/index.html`,
	`${GHPATH}/index.html`,
	`${GHPATH}/public/android-chrome-192x192.png`,
	`${GHPATH}/public/android-chrome-512x512.png`,
	`${GHPATH}/public/apple-touch-icon.png`,
	`${GHPATH}/public/favicon-16x16.png`,
	`${GHPATH}/public/favicon-32x32.png`,
	`${GHPATH}/public/favicon.ico`,
	`${GHPATH}/public/maskable_icon.png`,
	`${GHPATH}/service-worker.js`,
	`${GHPATH}/shinylive-sw.js`,
	`${GHPATH}/shinylive/browser-OYYBATHK.js`,
	`${GHPATH}/shinylive/browser-YJT5PK6V.js`,
	`${GHPATH}/shinylive/chunk-O5P2LFOG.js`,
	`${GHPATH}/shinylive/chunk-PHWSSKUM.js`,
	`${GHPATH}/shinylive/Editor.css`,
	`${GHPATH}/shinylive/Editor.js`,
	`${GHPATH}/shinylive/load-shinylive-sw.js`,
	`${GHPATH}/shinylive/lzstring-worker.js`,
	`${GHPATH}/shinylive/pyodide-worker.js`,
	`${GHPATH}/shinylive/run-python-blocks.js`,
	`${GHPATH}/shinylive/shinylive.css`,
	`${GHPATH}/shinylive/shinylive.js`,
	`${GHPATH}/shinylive/SourceSansPro-Regular.otf-PVQ5ZP77.woff2`,
	`${GHPATH}/shinylive/style-resets.css`,
	`${GHPATH}/shinylive/webr/esbuild.d.ts`,
	`${GHPATH}/shinylive/webr/library.data.gz`,
	`${GHPATH}/shinylive/webr/library.js.metadata`,
	`${GHPATH}/shinylive/webr/libRblas.so`,
	`${GHPATH}/shinylive/webr/libRlapack.so`,
	`${GHPATH}/shinylive/webr/packages/crosstalk/crosstalk_1.2.1.tgz`,
	`${GHPATH}/shinylive/webr/packages/DT/DT_0.33.tgz`,
	`${GHPATH}/shinylive/webr/packages/evaluate/evaluate_1.0.3.tgz`,
	`${GHPATH}/shinylive/webr/packages/highr/highr_0.11.tgz`,
	`${GHPATH}/shinylive/webr/packages/htmlwidgets/htmlwidgets_1.6.4.tgz`,
	`${GHPATH}/shinylive/webr/packages/knitr/knitr_1.49.tgz`,
	`${GHPATH}/shinylive/webr/packages/lazyeval/lazyeval_0.2.2.tgz`,
	`${GHPATH}/shinylive/webr/packages/metadata.rds`,
	`${GHPATH}/shinylive/webr/packages/proporz/proporz_1.5.0.tgz`,
	`${GHPATH}/shinylive/webr/packages/rmarkdown/rmarkdown_2.29.tgz`,
	`${GHPATH}/shinylive/webr/packages/tinytex/tinytex_0.54.tgz`,
	`${GHPATH}/shinylive/webr/packages/xfun/xfun_0.50.tgz`,
	`${GHPATH}/shinylive/webr/packages/yaml/yaml_2.3.10.tgz`,
	`${GHPATH}/shinylive/webr/R.bin.js`,
	`${GHPATH}/shinylive/webr/R.bin.js.bak`,
	`${GHPATH}/shinylive/webr/R.bin.wasm`,
	`${GHPATH}/shinylive/webr/repl/App.d.ts`,
	`${GHPATH}/shinylive/webr/repl/components/Editor.d.ts`,
	`${GHPATH}/shinylive/webr/repl/components/Files.d.ts`,
	`${GHPATH}/shinylive/webr/repl/components/Plot.d.ts`,
	`${GHPATH}/shinylive/webr/repl/components/Terminal.d.ts`,
	`${GHPATH}/shinylive/webr/repl/components/utils.d.ts`,
	`${GHPATH}/shinylive/webr/tests/packages/webr.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/chan/channel-postmessage.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/console.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/error.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/mount.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/proxy.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/robj.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/utils.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/webr-main.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/webr-r.test.d.ts`,
	`${GHPATH}/shinylive/webr/tests/webR/webr-worker.test.d.ts`,
	`${GHPATH}/shinylive/webr/vfs/etc/fonts/fonts.conf`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/doc.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/doc.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/demo.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/demo.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/base/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/compiler/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/datasets/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/datasets/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/datasets/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/datasets/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/demo.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/demo.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/graphics/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/afm.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/afm.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/demo.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/demo.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/enc.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/enc.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/fonts.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/fonts.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/libs.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/libs.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grDevices/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/doc.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/doc.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/grid/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/methods/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/parallel.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/parallel.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/splines/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/demo.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/demo.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/stats4/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tcltk.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tcltk.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/tools/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/translations.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/translations.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/translations/DESCRIPTION`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/doc.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/doc.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/misc.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/misc.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/utils/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/webr/help.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/webr/help.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/webr/html.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/library/webr/html.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/share.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/share.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/tests.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/lib/R/tests.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSans-Bold.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSans-BoldItalic.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSans-Italic.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSans-Regular.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSansMono-Bold.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSansMono-Regular.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSerif-Bold.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSerif-BoldItalic.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSerif-Italic.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/fonts/NotoSerif-Regular.ttf`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/gdal.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/gdal.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/proj.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/proj.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/udunits.data.gz`,
	`${GHPATH}/shinylive/webr/vfs/usr/share/udunits.js.metadata`,
	`${GHPATH}/shinylive/webr/vfs/var/cache/fontconfig/3830d5c3ddfd5cd38a049b759396e72e-le32d8.cache-7`,
	`${GHPATH}/shinylive/webr/vfs/var/cache/fontconfig/CACHEDIR.TAG`,
	`${GHPATH}/shinylive/webr/webr-serviceworker.js`,
	`${GHPATH}/shinylive/webr/webr-serviceworker.js.map`,
	`${GHPATH}/shinylive/webr/webr-serviceworker.mjs`,
	`${GHPATH}/shinylive/webr/webr-serviceworker.mjs.map`,
	`${GHPATH}/shinylive/webr/webr-worker.js`,
	`${GHPATH}/shinylive/webr/webr-worker.js.map`,
	`${GHPATH}/shinylive/webr/webr.cjs`,
	`${GHPATH}/shinylive/webr/webr.cjs.map`,
	`${GHPATH}/shinylive/webr/webr.mjs`,
	`${GHPATH}/shinylive/webr/webr.mjs.map`,
	`${GHPATH}/shinylive/webr/webR/chan/channel-common.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/channel-postmessage.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/channel-service.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/channel-shared.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/channel.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/message.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/queue.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/serviceworker.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/task-common.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/task-main.d.ts`,
	`${GHPATH}/shinylive/webr/webR/chan/task-worker.d.ts`,
	`${GHPATH}/shinylive/webr/webR/compat.d.ts`,
	`${GHPATH}/shinylive/webr/webR/config.d.ts`,
	`${GHPATH}/shinylive/webr/webR/console.d.ts`,
	`${GHPATH}/shinylive/webr/webR/emscripten.d.ts`,
	`${GHPATH}/shinylive/webr/webR/error.d.ts`,
	`${GHPATH}/shinylive/webr/webR/mount.d.ts`,
	`${GHPATH}/shinylive/webr/webR/payload.d.ts`,
	`${GHPATH}/shinylive/webr/webR/proxy.d.ts`,
	`${GHPATH}/shinylive/webr/webR/robj-main.d.ts`,
	`${GHPATH}/shinylive/webr/webR/robj-worker.d.ts`,
	`${GHPATH}/shinylive/webr/webR/robj.d.ts`,
	`${GHPATH}/shinylive/webr/webR/utils-r.d.ts`,
	`${GHPATH}/shinylive/webr/webR/utils.d.ts`,
	`${GHPATH}/shinylive/webr/webR/webr-chan.d.ts`,
	`${GHPATH}/shinylive/webr/webR/webr-main.d.ts`,
	`${GHPATH}/shinylive/webr/webR/webr-worker.d.ts`,
	`${GHPATH}/site.webmanifest`,
  // add more paths if you need
  // `${GHPATH}/js/app.js`
]

const CACHE_NAME = APP_PREFIX + VERSION
self.addEventListener('fetch', function (e) {
  console.log('Fetch request : ' + e.request.url);
  e.respondWith(
    caches.match(e.request).then(function (request) {
      if (request) {
        console.log('Responding with cache : ' + e.request.url);
        return request
      } else {
        console.log('File is not cached, fetching : ' + e.request.url);
        return fetch(e.request)
      }
    })
  )
})

self.addEventListener('install', function (e) {
  e.waitUntil(
    caches.open(CACHE_NAME).then(function (cache) {
      console.log('Installing cache : ' + CACHE_NAME);
      return cache.addAll(URLS)
    })
  )
})

self.addEventListener('activate', function (e) {
  e.waitUntil(
    caches.keys().then(function (keyList) {
      var cacheWhitelist = keyList.filter(function (key) {
        return key.indexOf(APP_PREFIX)
      })
      cacheWhitelist.push(CACHE_NAME);
      return Promise.all(keyList.map(function (key, i) {
        if (cacheWhitelist.indexOf(key) === -1) {
          console.log('Deleting cache : ' + keyList[i]);
          return caches.delete(keyList[i])
        }
      }))
    })
  )
})
